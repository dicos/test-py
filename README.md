# Python (FastAPI) | test task

## Важно

1. Описывать документацию
2. Использовать `response` классы
3. Все данные должны прилетать через схемы (CreatePostSchema)

## ЗАДАЧИ

Задачи перечислены по возрастанию сложности.
Дополнительные задачи необязательны, но их выполнение может улучшить впечатление о Вас.

Все выполненные задачи соберите в одной ветке и сделайте Pull Request в Master **в своём репозитории**. Исходный **код тестового задания не должен быть отформатирован** (нужно, чтобы в Pull Request были только касающиеся задач изменения)

API должно работать через HTTP-запросы


**Задача 1**. `/src/auth` - Реализовать аутентификацию (token). Модель пользователя уже содержит наброски для работы.

**Задача 2**. `/src/post` - Реализовать возможность добавления постов. Модель уже содержит наброски для работы.

**Задача 3**. `/src/story` - Реализовать возможность добавления истории. Модель уже содержит наброски для работы.

**Задача 3**. `/src/post/like` - Реализовать возможность лайкнуть пост или комментарий, необходимо создать миграцию.

**Задача 4**. `/src/post/comment` - Реализовать возможность добавления комментариев. Дополнительно: реализовать вложенные комментарии, количество уровней вложенности не ограничено.

**Задача 5**. `/src/story/view` - Реализовать логику просмотра истории, важно видеть текущий пользователь посмотрел историю или нет, необходимо создать миграцию.

**Задача 6**. `/main.py` - Реализовать логику онлайн пользователя (middlware), для этого уже имеется поле `last_seen` в модельке пользователя

**Задача 7**. `/main.py` - Создать task с промежуктом выполнения 30мин, который будет удалять истории где `created_at >= 24 hours`

## Дополнительные задачи

**Доп. задача 1**. `/src/story/feed` - Реализовать вомзонжость получения истории пользователя с сортировкой важно видеть какие истории просмотрены и индекс не просмотренной истории, так-же нужно отдать время в human_format'e (секунды, минуты, часы)
Пример вывода:
```
{
    id: 1,
    is_viewed: false,
    index: 2,
    ...
    stories: [
        {id: 1, ... is_viewed: true, human_format: "13 ч."},
        {id: 1, ... is_viewed: true, human_format: "2 ч."},
        {id: 1, ... is_viewed: false, human_format: "29 мин."},
        {id: 1, ... is_viewed: false, human_format: "10 сек."},
    ]
}
```

**Доп. задача 2**. `/src/auth` - Реализовать логику авторизации с использованием одноразовых кодов (длина 4 символа) использованием кэша (редис) и кол-во попыток = 3

**Доп. задача 3**. `/src/common/log.py` - Реализовать систему логирование, логироваться должны записи попдающие в базу (создание, обновление, удаления). Должен создаваться файл в `app.log` в корне проекта